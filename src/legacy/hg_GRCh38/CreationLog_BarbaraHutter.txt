Sept 8, 2014: downloaded from Ensembl 76 ftp
Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa.gz
(softmasked, all chromosomes and unplaced scaffolds)

mkdir -p /icgc/ngs_share/assemblies/legacy.hg_GRCh38/sequence
cd /icgc/ngs_share/assemblies/legacy.hg_GRCh38/sequence
mv ~/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa.gz .

# sorting order is lexicographical: 1, 10, ..., 19, 2, 20, 21, 22, 3, ..., 9, MT, X, Y
# followed by a lot of GL000... and KI... These are the GenBank Accession.version identifiers of
# unlocalized scaffolds that are sorted by size, compare:
# http://mirrors.vbi.vt.edu/mirrors/ftp.ncbi.nih.gov/genomes/Homo_sapiens/Assembled_chromosomes/unlocalized_accessions_GRCh38
# CAUTION: the python coverage scripts have to be hacked to also ignore the contigs starting with "KI"
# (it ignores only those with prefix GL0, MT, chrM, and _hap and _random)

samtools faidx Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa

# to have a convenient short name
ln -s Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa legacy.hg_GRCh38.fa
ln -s Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa.fai legacy.hg_GRCh38.fa.fai

# bwa index for version 0.6+ with convenient short name
mkdir -p /icgc/ngs_share/assemblies/legacy.hg_GRCh38/indexes/bwa/bwa06
cd /icgc/ngs_share/assemblies/legacy.hg_GRCh38/indexes/bwa/bwa06
ln -s ../../../sequence/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa legacy.hg_GRCh38.fa
ln -s ../../../sequence/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa.fai legacy.hg_GRCh38.fa.fai
bwa-0.7.7 index legacy.hg_GRCh38.fa

[bwa_index] Pack FASTA... 58.66 sec
[bwa_index] Construct BWT for the packed sequence...
[BWTIncCreate] textLength=6199501436, availableWord=448219384


# stats
mkdir /icgc/ngs_share/assemblies/legacy.hg_GRCh38/stats
cd /icgc/ngs_share/assemblies/legacy.hg_GRCh38/stats
# all contigs with their lengths and Ns etc.
/home/hutter/Perlprog/tools/lengthSumN.pl ../sequence/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa > legacy.hg_GRCh38.fa.contigInformation.txt
#sum chr1-chrY: 3099734149, Ns: 186728319, length without Ns: 2913005830

# lengths of all chromosomes and contigs without Ns
sed '1d' legacy.hg_GRCh38.fa.contigInformation.txt | awk '{print $1 "\t" $NF}' > legacy.hg_GRCh38.fa.chrLenOnlyACGT.tab

# lengths of "real" chromosomes without Ns
head -n 25 legacy.hg_GRCh38.fa.chrLenOnlyACGT.tab | grep -v "MT" > legacy.hg_GRCh38.fa.chrLenOnlyACGT_realChromosomes.tab

# lengths of "real" chromosomes (_with_ N) for usage in tools that pre-allocate chromosome-sized arrays
head -n 26 legacy.hg_GRCh38.fa.contigInformation.txt | grep -v "MT" | awk '{print $1 "\t" $(NF-2)}' > chrlengths.txt

# sequence and index directory needs a .dict file that looks like a SAM header, for use of the GATK
cd /icgc/ngs_share/assemblies/legacy.hg_GRCh38
echo -e "@HD\tVN:1.0\tSO:unsorted" > sequence/legacy.hg_GRCh38.dict
sed '1d' stats/legacy.hg_GRCh38.fa.contigInformation.txt | awk '{print "@SQ\tSN:" $1 "\tLN:" $5 "\tUR:file:/icgc/ngs_share/assemblies/legacy.hg_GRCh38/sequence/legacy.hg_GRCh38.fa"}' >> sequence/legacy.hg_GRCh38.dict
cd sequence
ln -s legacy.hg_GRCh38.dict Homo_sapiens.GRCh38.dna_sm.primary_assembly.dict
cd ../../../indexes/bwa/bwa06
ln -s ../../../sequence/Homo_sapiens.GRCh38.dna_sm.primary_assembly.dict legacy.hg_GRCh38.dict


##########Annotation##############
UCSC:
wgEncodeGencodeCompV19
refGene
rmsk
simpleRepeat

Gencode20 is for GRCh38
http://www.gencodegenes.org/releases/20.html
